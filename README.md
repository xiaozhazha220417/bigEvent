# 项目准备

1. 准备素材
2. 创建网页（index.html 和 login.html）

# 登陆页面的书写

-   1、新建 login.css 和 login.js 文件
-   2、引入新建文件和依赖文件
-   3、书写 html 和 css 代码
    -   完成登陆表单框
    -   完成注册表单框
-   4、书写 js 代码
    -   完成点击文字 切换 登陆和注册
        -   对 dom 节点的显示和隐藏完成 切换的功能

# 表单预验证功能

-   使用 layui 插件库实现表单预验证功能
    -   ① 在表单的 input 中写入 `lay-verify="required"`
    -   ② 在文件底部导入 layui.all.js 文件
    -   ③ 使用自定义的 layui 的校验规则
        -   1、获取 `layui.form` 对象
        -   2、通过 `form.verify()` 方法 自定义 密码 校验规则 校验规则 key 为 pwd
        -   3、设置校验规则 在 页面的 input 添加校验规则 `lay-verify="required|pwd"`
        -   4、设置自定义 确认密码 校验规则 校验规则 key 为 repwd ，添加校验规则

# 完成注册功能

-   使用老师提供的接口完成注册
    -   ① 给注册表单 设置 id 值
    -   ② 获取注册表单 监控注册表单的提交事件 `$('#form_reg').on('submit',函数体)`
    -   ③ 获取事件对象，禁止注册表单默认提交事件 `e.preventDefault()`
    -   ④ 根据接口文档 发起 post 请求，完成注册
-   优化用户注册提示
    -   使用 `layui.layer.msg()` 方法，优化用户注册提示信息

# 完成登录功能

-   使用老师提供的接口完成登录
    -   ① 给登录表单 设置 id 值
    -   ② 获取登录表单 监控注册表单的提交事件 `$('#form_login').on('submit',函数体)`
    -   ③ 获取事件对象，禁止注册表单默认提交事件 `e.preventDefault()`
    -   ④ 根据接口文档 发起 post 请求，完成登录
    -   ⑤ 提示登录成功跳转到首页
    -   注意：
        -   ① 登录的用户都有 token 秘钥，来保证用户权限，把秘钥保存到 `localStorage.setItem('token',res.token);` 本地存储上面
-   优化代码
    -   ① 优化接口链接 新建 baseAPI.js 文件 生成全局接口的根路径

# 首页页面的书写

-   ① 复制 layui 库的结构布局代码，完成首页的基本布局
    -   ① 修改 结构布局
    -   ② 引入样式文件 layui.css 和 layui.all.js
-   ② 完成侧边栏的基本布局
    -   ① 给 侧边栏 加属性 `lay-shrink="all"` 完成当前展开列表项，其他列表项不展开
    -   ② 删除不需要的结构布局
-   ③ 完成字体图标引入
    -   ① 引入 字体图标库文件 iconfont.css 和 layui.css
    -   ② 完成 字体图标 插入 修改样式
-   ④ 完成内容主体区域
    -   ① 使用 `iframe` 标签 通过 `a 标签里面的 target 属性 进行连接 iframe 标签中的 name 属性` 就可以完成页面内的跳转
-   ⑤ 完成用户头像 自定义修改 和 默认样式头像 的布局
    -   ① 书写 js 完成 显示用户头像
-   ⑥ 完成用户名 匹配
    -   ① 书写 js 完成 用户名匹配

# 完成用户退出功能

-   ① 绑定退出按钮点击事件
-   ② 通过 layui 库 `confirm()` 方法实现退出登录提示信息
-   ③ 在 layui 库 `confirm()` 方法的回调函数中 清除本地存储，重新跳转到 登录页面

# 完成非法用户拦截

-   通过 Ajax 请求的回调函数 `complete` 完成 拦截非法用户
    -   `complete` 发起 Ajax 请求不管成功和失败都会调用 complete 回调函数，检测服务器返回的信息判断用户是否合法，不合法就强制退出

# 完成个人中心 基本信息 的功能

-   ① 新建文件 user_info.html user_info.css user_info.js
-   ② 书写 基本页面布局
-   ③ 完成修改用户基本信息功能
    -   ① 通过 layui 监测表单的提交信息
    -   ② 初始化用户信息 发起 get 的请求，渲染页面
    -   ③ 重置按钮功能 表示再一次 发起 get 请求，渲染页面
    -   ④ 提交修改按钮功能 表示 发起 post 请求，把表单的数据提交给服务器修改用户基本信息
    -   ⑤ 根据响应回来的数据，重新渲染页面信息,调用父页面的方法 `window.parent.getUserInfo();`

# 完成重置密码功能

-   ① 新建文件 user_pwd.html user_pwd.css user_pwd.js
-   ② 书写 基本页面布局
-   ③ 完成 重置密码 功能
    -   ① 通过 layui 监测表单的提交信息
    -   ② 提交 重置密码 请求 完成重置密码

# 完成更换头像功能

-   ① 新建文件 user_avatar.html user_avatar.css user_avatar.js
-   ② 书写 基本页面布局
-   ③ 完成 更换头像 功能
    -   ① 通过 插件`cropper`完成图片裁切
    -   ② 给页面结构 增加 提交文件的 input 并且隐藏 `<input type="file" id="file" accept="image/png,image/jpeg" />`
    -   ③ 为上传按钮绑定点击事件 --- 弹出选择图片的 功能框
    -   ④ 为文件选择框绑定 change 事件 --- 当用户提交了图片后 修改 页面裁切区域的图片
    -   ⑤ 为确定按钮，绑定事件 --- 头像上传服务器 ，重新渲染页面

# 文章类别 功能

-   ① 创建并显示文章类别页面
    -   ① 新建文件 article_cate.html article_cate.css article_cate.js
    -   ② 引入依赖的 css 文件
    -   ④ **注意** 安装新的插件 express，用来部分刷新页面的插件
-   ② 快速绘制文章类别页面的基本结构
    -   ① 完成基本结构布局和样式的书写
-   ③ 获取并使用模板引擎渲染表格的数据
    -   ① 引入依赖的 js 文件
    -   ② 书写 模板引擎 `tpl-table`
    -   ③ 通过`initArticleCateList()` 函数初始化页面文章数据
-   ④ 使用 layer.open 实现弹出层效果
    -   ① 给 `添加类别` 绑定事件
    -   ② 使用 `layer.open()` 实现弹出层效果
-   ⑤ 在弹出层中渲染 form 表单结构
    -   ① 使用 `layer.open()` 实现的弹出层，结构不对需要自己手动添加结构
    -   ② 书写页面结构 `<script type="text/html" id="dialog-add">`
    -   ③ 使用 `layer.open()` 引入自己写的结构 `content: $("#dialog-add").html()`
-   ⑥ 实现添加文章分类的功能
    -   ① 通过 `layer.open()` 实现的弹出层 的 form 表单需要把数据提交
    -   ② 通过代理的形式，为`#form-add` 表单绑定 sbumit 提交事件
    -   ③ 监听 表单提交事件 ，完成文章分类添加功能
-   ⑦ 点击编辑按钮展示修改文章分类的弹出层
    -   ① 给每一个 编辑按钮 添加 点击事件 通过代理模式绑定点击事件
    -   ② 写好 弹出层 结构模板
    -   ② 在事件中 设置弹出层 的 页面结构 通过 `layer.open()`
    -   ④ 绑定 事件 和 绑定 结构模板 ，完成 点击编辑 弹出 信息框
-   ⑧ 为修改文章分类的弹出层填充表单数据
    -   ① 点击编辑按钮弹出 信息框 显示基本信息
    -   ② 给 编辑按钮 添加自定义 属性获取 id （给 form 表单中设置隐藏的表单获取 id 值）
    -   ③ 发起 get 请求 获取 对应的 id 数据，
    -   ④ 渲染结构
-   ⑨ 更新文章分类的数据
    -   ① 通过代理模式监听 form 表单 的提交事件
    -   ② 发起 post 请求，来修改 弹出层 的基本信息
    -   ③ 修改服务器数据成功后，重新渲染页面数据，关闭弹出层
-   ⑩ 删除文章分类
    -   ① 通过代理模式 给所有的 删除 按钮 绑定点击事件
    -   ② 通过 id 获取删除条的数据
    -   ③ 通过 `layer.confirm` 设置 提示层，并且发起 get 请求
    -   ④ 删除 id 所在条的数据，重新渲染页面数据，关闭提示层

# 文章列表 功能

-   ① 创建文章列表页面
    -   ① 导入 css 文件和 js 文件
    -   ② 书写 css 样式 完成 页面基本结构
-   ② 定义查询参数对象 q
    -   ① 定义 渲染 文章列表的 文章标题的数据 q
-   ③ 请求文章列表数据并使用模板引擎渲染列表结构
    -   ① 定义 获取文章列表数据的方法
    -   ② 在函数中 发起 get 请求 ，定模板引擎
    -   ③ 在响应数据后 ，通过模板引擎渲染页面数据
-   ③ 定义美化时间格式的过滤器
    -   ① 定义美化时间的过滤器
    -   ② 复制自己 ajax 资料那边的 时间过滤器
    -   ③ 在模板引擎中引用 时间过滤器
-   ④ 绘制筛选区域的 UI 结构
    -   ① 书写 article_list.html 页面的 筛选区域的 页面结构
-   ⑤ 发起请求获取并渲染文章分类的下拉选择框
    -   ① 定义初始化文章分类的方法
    -   ② 在函数中 发起 get 请求 ，定模板引擎
    -   ③ 在响应数据后 ，通过模板引擎渲染页面数据
-   ⑥ 使用 form.render 方法 重新 渲染 表单区域的 UI 结构
    -   ① 渲染页面的时候，没有渲染数据到页面
    -   ② 因为 layui 的渲染机制导致没有成功渲染页面数据，
    -   ③ 分析：默认没有任何可选项，然后加载 layui.all.js 文件，然后就开始渲染页面，因为渲染页面的时候，页面结构里面没有数据，所以 layui 就没有渲染数据，后面发起 ajax 请求，响应回来的数据，并没有被 laiui 检测到，，所以 layui 还是保持原样渲染没有数据的结构。
    -   ④ 解决方法: 通知 layui 重新渲染一下页面 `form.render();`
-   ⑦ 实现筛选的功能
    -   ① 因为筛选区域本身就是 form 表单，可以通过发送请求的方式来筛选数据
    -   ② 为筛选表单绑定 submit 事件
    -   ③ 更新 文章分类的 id 和 更新 文章的发布状态
    -   ④ 通过最新的 id 和 state 重新渲染页面数据

## 分页 功能

-   ① 定义渲染分页的 renderPage 方法
    -   ① 定义渲染分页的方法 设置形参 total 接收 总条数
    -   ② 在 表格渲染完成以后调用 renderPage 方法 传递实参 res.total 总条数
-   ② 调用 laypage.render 方法渲染分页的基本结构
    -   ① 调用 laypage.render() 方法来渲染分页的结构
    -   ② 传递参数 elem（分页容器的 Id） | count（总数据条数） | limit（每页显示几条数据） | curr（设置默认被选中的分页）
-   ③ 在 jump 回调函数中通过 obj.curr 获取到最新的页码值
    -   ① 定义 jump 回调函数（分页发生切换的时候，触发 jump 回调）
    -   ② 通过 jump 回调函数 拿到 最新的 页码值
    -   ③ 跟新 页面值 `q.pagenum`
-   ④ 演示直接调用 initTable 方法时死循环的问题
    -   ① 不能直接调用 initTable() 渲染页面的函数
-   ⑤ 分析 jump 回调函数发生死循环的原因
    -   ① 产生死循环的原因：jump 触发的回调函数有两种，1. 点击页码的时候，会触发 jump 回调，因为页面没有点击，所以产生死循环的原因不是这个；2. 只要调用了 laypage.render() 方法，就会触发 jump 回调,因为页面开始渲染的时候就调用了 initTable() 在 initTable()函数中调用了 renderPage() 函数 ，renderPage()函数调用 laypage.render() 方法， laypage.render() 方法 调用了 initTable()，所以就这样死循环了
-   ⑥ 解决 jump 回调函数发生死循环的问题
    -   ① 通过 jump 回调函数中的 `first` 形参 解决 死循环问题
    -   ② jump 回调函数中 `first` 是一个布尔值，当 jump 触发的方式 是 laypage.render() 方法 时，first 返回 true，如果是通过点击页码的方式 触发 laypage.render() 方法 ，first 返回 undefined
    -   ③ 判断 first 的状态 ，只用点击页码的时候才触发 initTable() 方法 `if(!first){initTable()}`
-   ⑦ 自定义分页的功能项
    -   ① 添加 自定义 分页
    -   ② 添加 参数 layout（自定义排版。可选值有：count（总条目输区域）、prev（上一页区域）、page（分页区域）、next（下一页区域）、limit（条目选项区域）、refresh（页面刷新区域。注意：layui 2.3.0 新增） 、skip（快捷跳页区域）），参数是数组
    -   ③ 添加 参数 limits （每页展示多少条），参数是数组
-   ⑧ 实现切换每页展示多少条数据的功能
    -   通过 jump 回调函数 拿到 当前设置 的显示条数 `obj.limit`
    -   将页面 显示 条数 赋值 给 `q.pagesize` 发起请求来实时更新页面筛选的数据

## 删除文章 功能

-   ① 实现删除文章的功能
    -   ① 通过代理的形式，为删除按钮绑定点击事件处理程序
    -   ② 通过 layui 设置 弹出层 提示用户 是否删除
    -   ③ 给 删除按钮 动态 绑定 id 属性 ，通过 id 删除 文章
    -   ④ 重新渲染 页面
-   ② 分析删除文章时存在的问题
    -   ① 重新渲染页面数据的时候，因为当前的页码是固定的，所以，我删除了本页码的所以数据后，分页跳转到别的页码，因为发送渲染请求的时候，页码是没有更新的，所以渲染页面的时候没有数据
-   ③ 判断页面中是否还有剩余数据
    -   ① 通过 判断 页面的删除按钮的个数来判断页面是否有剩余数据
    -   ② 获取页面删除按钮的个数
    -   ③ 如果删除按钮个数等于 1 个的时候表示页面没有数据了
    -   ④ 如果页面没有数据了就更新页码值
    -   ⑤ 重新渲染页面数据
-   ④ 实现页码值 -1 的操作
    -   ① 在判断删除按钮个数的时候，更新页码值
    -   ② 当页码值等于 1 的之后 不需要更新页码值 如果当前页码值不是 1，则需要当前页码值 -1
    -   ③ 更新完页码值后，重新渲染页面数据

## 编辑文章 功能



# 发布文章 功能

-   ① 创建文章发布页面的基本结构
    -   ① 导入 css 文件和 js 文件
    -   ② 书写 css 样式 完成 页面基本结构
-   ② 新建基本的表单结构
    -   ① 复制 layui 的页面结构，完成 文章标题 区域的页面结构
-   ③ 渲染文章类别对应的下拉选择框结构
    -   ① 复制 文章标题 区域 ，生成 文章类别 区域的页面结构
    -   ② 修改 文章类别 为 下拉框
    -   ③ 定义加载文章类别的方法
    -   ④ 定义 模板引擎 生成 下拉框实时的页面结构
    -   ⑤ 实时渲染页面结构的时候 需要 执行 `form.render();`
-   ④ 渲染富文本编辑器
    -   ① 富文本编辑器的实现步骤 看 富文本和封面的笔记
-   ⑤ 渲染封面裁剪区域
    -   ① 封面裁剪区域的实现步骤 看 富文本和封面的笔记
-   ⑥ 渲染提交按钮区域
    -   ① 书写 发布按钮 和 存为草稿按钮
-   ⑦ 点击选择封面按钮打开文件选择框
    -   ① 在 第四行中 里面 加入 隐藏的文件选择框
    -   ② 为选择封面的按钮，绑定点击事件处理函数
    -   ③ 在处理程序函数中 ，触发 隐藏的文件选择框 ，完成 选择图片
-   ⑧ 将选择的图片设置到裁剪区域中
    -   ① 为隐藏的文件选择框绑定 change 事件
    -   ② 查看 富文本和封面的笔记 复制 粘贴代码
-   ⑨ 分析发布文章的实现步骤
    -   ① 发布请求之前 准备数据
    -   ② 准备 state 数据
-   ⑩ 基于 form 表单创建 fordata 对象
    -   ① 准备 forData 数据
    -   ② 把 准备好的 state 数据 添加 到 fordata 对象中
-   ⑪ 将裁剪后的封面追加到 forData 对象 中
    -   ① 准备 forData 数据
    -   ② 处理 `cover_img` 数据
    -   ③ 把 准备好的 `cover_img` 数据 添加 到 fordata 对象中
    -   ④ 注意 这个 js 文件需要写 **入口函数**
-   ⑫ 发起 Ajax 请求实现发布文章的功能
    -   ① 定义一个发布文章的方法，发送请求
